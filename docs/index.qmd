--- 
format: 
  html:
    code-fold: TRUE
    fig-format: svg
bibliography: "../manuscript/misc/ref.bib"
execute: 
  echo: false
  warning: false
  error: false
lang: es
toc: true
toc-title: "Índice"
number-sections: true
fig-responsive: true
---

# Análisis Estadístico

## Descriptivos

Para los estadísticos descriptivos se reportaron la media y la desviación estándar (media ± sd) para las variables continuas, y la frecuencia absoluta (n) y relativa (%) para las variables categóricas.

## Marco de análisis

Utilizamos un marco bayesiano para explorar las complejas interacciones entre factores clave asociados con el dolor no oncológico. Los modelos bayesianos son preferibles a los métodos frecuentistas tradicionales porque pueden cuantificar la incertidumbre y estimar los parámetros del modelo de forma más exhaustiva. Además, la inferencia bayesiana permite la inclusión de conocimientos previos sobre los parámetros del modelo, lo que posibilita la integración de hallazgos existentes e investigaciones anteriores. El marco bayesiano proporciona distribuciones posteriores que permiten una interpretación probabilística de las estimaciones de los parámetros con intervalos creíbles que reflejan la incertidumbre de los mismos.

Para evaluar el impacto de factores sociodemográficos, variables de actividad física, calidad del sueño y cronotipo, se desarrollaron cuatro modelos lineales generalizados bayesianos. Estos modelos se utilizaron para analizar el efecto de dichas variables en cuatro dominios del dolor: a) el impacto percibido del dolor en la funcionalidad, b) la intensidad percibida del dolor, c) la frecuencia reportada de episodios dolorosos, y d) la presencia de dolor persistente durante un periodo igual o mayor a 3 meses.

## Impacto funcional e Intensidad del Dolor

Para evaluar el efecto del impacto percibido del dolor sobre la funcionalidad y la intensidad percibida de dolor, ambas escalas que van de 0 a 10, utilizamos un modelo beta-binomial bayesiano, parametrizado según la @eq-first-model-1.

$$
\begin{aligned}
y_i \mid n, \mu_i, \phi &\sim \text{Beta-Binomial}\left(n, a, b\right) \\
a &= \mu_i \cdot \phi \\
b &= (1 - \mu_i) \cdot \phi \\
\end{aligned}
$$ {#eq-first-model-1}

En este modelo, los parámetros distribucionales ($a$, $b$), que ajustan la forma de la variable respuesta ($y_i$), dependen de la media esperada ($\mu_i$) y la dispersión ($\phi$). La combinación lineal del intercepto ($\beta_0$) y los coeficientes ($\beta_j$) de las variables independientes ($X_{ij}$) se utilizó para estimar $\mu_i$ en la escala logit (ver @eq-first-model-2).

$$
\begin{aligned}
\text{logit}(\mu_i) &= \beta_0 + \sum_{j=1}^{p} \beta_j X_{ij} \\
\log(\phi) &= \gamma_0
\end{aligned}
$$ {#eq-first-model-2}

## Frecuencia del dolor

La frecuencia del dolor, reportada como una variable ordinal de cinco niveles, se modeló utilizando un modelo de regresión ordinal bayesiano. Este modelo permitió evaluar la probabilidad acumulada de cada nivel de frecuencia, condicionado a las variables de interés, y se parametrizó según la @eq-first-model-3.

$$
\begin{aligned}
\text{logit}~P(Y \leq k | x) &= \alpha_k - \eta \\
\eta &= \sum_{j=1}^{p} \beta_j X_{ij}
\end{aligned}
$$ {#eq-first-model-3}

Donde $\alpha_k$ son los umbrales específicos para cada nivel ordinal $k$, y $\beta_j$ son los coeficientes de las variables independientes $X_{ij}$. Los umbrales $\alpha_k$ se ordenan como parámetros del modelo: $\alpha_0 = -\infty < \alpha_1 < \cdots < \alpha_{k} = \infty$.

## Estado de dolor persistente

Para valorar la probabilidad de dolor persistente por un periodo de tiempo igual o mayor a 3 meses, utilizamos un modelo de regresión logística bayesiana, parametrizado según la @eq-first-model-4.

$$
\begin{aligned}
y_i \mid X_i &\sim \text{Bernoulli}\left(p_i\right) \\
\text{logit}(p_i) &= \beta_0 + \sum_{j=1}^{p} \beta_j X_{ij}
\end{aligned}
$$ {#eq-first-model-4}

En este modelo, $y_i$ denota la presencia o ausencia de dolor persistente, y $p_i$ es la probabilidad asociada. La función logit de $p_i$ se expresa como una combinación lineal de las variables independientes $X_{ij}$, con coeficientes $\beta_j$ e intercepto $\beta_0$.

## Priors e Hiperparámetros

Para los coeficientes lineales, se eligieron priors con un efecto regularizador sobre los efectos principales, basados en una distribución normal centrados en cero y con una desviación estandar de 3, (i.e., $\beta \sim \mathcal{N}(0,3)$), limitando el efecto de observaciones influyentes y mejorando la convergencia de los modelos.

Para la estimación de los modelos, se usó el algoritmo No-U-Turn, variante del algoritmo Monte Carlo Hamiltoniano, por medio del paquete *brms* (v2.21.0) y *rstan* (v2.32.6). Los parámetros del algoritmo fueron 4 cadenas de Markov, 2000 iteraciones iniciales de preparación y 2500 iteraciones efectivas por cadena (10 mil en total). 

## Reporte de Indices

Siguiendo el marco **S**equential **E**ffect e**X**istence and s**I**gnificance **T**esting (SEXIT) para describir los efectos a partir de modelos bayesianos [@makowski2019indices], se comunicaron la mediana y el IC~95%~ (utilizando el intervalo de mayor densidad) como medida de centralidad e incertidumbre, la probabilidad de dirección (pd) como medida de existencia, la proporción de la distribución de probabilidad posterior del signo de la mediana que cae fuera de la región de equivalencia práctica (ROPE) como medida de significación práctica (ps), estimada como una décima parte (1/10 = 0. 1) de la DE de la variable de respuesta, y el factor de Bayes (BF~10~) utilizando la relación de densidad de Savage-Dickey contra el punto nulo que indica si el valor nulo se ha vuelto menos o más probable dados los datos observados [@heck2019caveat], utilizando esto como una medida de la magnitud absoluta de la evidencia a favor o en contra de la hipótesis nula (de no efecto).
Teniendo en cuenta que ROPE, y por tanto ps, son sensibles a la escala a nivel de predictor, se estandarizó la edad, así como los puntajes obtenidos de los cuestionarios.

Para la interpretación de BF hemos considerado: BF = 1, ninguna evidencia; 1 < BF <= 3, anecdótico; 3 < BF <= 10, moderado; 10 < BF <= 30, fuerte; 30 < BF <= 100, muy fuerte; y BF > 100, como evidencia extrema [@jeffreys1998theory]. Para la proporción de la posterior en el ROPE consideramos: < 1%, significativo; < 2,5%, probablemente significativo; ≤ 97,5% & ≥ 2,5%, significación indecisa; > 97,5%, probablemente insignificante; > 99%, insignificante [@makowski2019indices]. 

## Convergencia

La convergencia y estabilidad del muestreo bayesiano se ha evaluado mediante R-hat, que debe ser inferior a 1,01 [@vehtari2019rank], el tamaño efectivo de la muestra (ESS), que debe ser superior a 1000 [@brms], y la inspección visual de los traceplots y las comprobaciones predictivas posteriores. Todos los análisis estadísticos se calcularon e implementaron en el lenguaje de programación R [@rlanguage].

# Resultados

```{r r-packages}
#| include: false

## Cargamos los paquetes
library(data.table) # Para manipular los datos
library(brms) # modelado bayesiano
library(tidybayes) # Manipulación de la distribución posterior
library(bayestestR)
library(gtsummary) # Tablas
library(ggplot2) # Gráficos

## Cargamos funciones
```

## Caracterización de la muestra

```{r data}
## Cargamos los datos
load("../data/chronic.RData")
```

La muestra evalauda consistió de 157 individuos (52 hombres, 98 mujeres y 7 no desearon responder), de los cuales 116 (73.1%) reportaron tener dolor frecuente por más de 3 meses, mientras que solo 41 (26.1%) reportaron dolor por un tiempo menor al mencionado. Las características de la muestra evaluada pueden observarse en la tabla 1.

**Tabla 1**. Características sociodemográficas, de actividad física, calidad de sueño y cronotipo de los participantes del estudio. Además de las características globales de la muestra, se presentan las diferencias entre grupos de sexo y duración de dolor.

:::{.column-page-inset-left}
```{r table-1}
readRDS(file = "../manuscript/tables/table-1.RDS")
```
:::

## Efecto de factores contextuales y sociodemogreaficos en el dolor

```{r mod-factores-full}
mc1_factores <- readRDS("../models/factores-y-dolor/mc1_factores.RDS")
mc2_factores <- readRDS("../models/factores-y-dolor/mc2_factores.RDS")
mc3_factores <- readRDS("../models/factores-y-dolor/mc3_factores.RDS")
mc4_factores <- readRDS("../models/factores-y-dolor/mc4_factores.RDS")
```

```{r fig-factores}
#| fig-width: 12
#| fig-asp: .7
#| fig-column: screen-inset-left

p1 <- local({
  posterior <- mc1_factores |> 
    as_draws_df(variable = "^b", regex = T)
  names(posterior) <- c("Intercepto", "Edad (+1 SD)", "Genero: (Femenino) - (Masculino)", "Universidad: (Aysén) - (Magallanes)", "Área de estudio: (Salud) - (Ingeniería)", "Área de estudio: (Social) - (Ingeniería)", "Alcohol: (No) - (Sí)", "Tabaco: (No) - (Sí)", ".chain", ".iteration", ".draw")
  posterior <-as.data.table(posterior) |> 
    melt(id.vars = c(".chain", ".iteration", ".draw"))
  posterior[!grepl("Intercepto", variable)]
}) |> 
  ggplot(aes(value, variable)) +
  stat_halfeye() +
  annotate(geom = "area", 
           x = c(-.18,-.18,.18,.18), 
           y = c(0,Inf,Inf,0), alpha = .3, 
           fill = "darkred") +
  labs(y = NULL, x = "Log-odds", title = "Impacto funcional sobre el dolor") +
  theme_classic()

p2 <- local({
  posterior <- mc2_factores |> 
    as_draws_df(variable = "^b", regex = T)
  names(posterior) <- c("Intercepto", "Edad (+1 SD)", "Genero: (Femenino) - (Masculino)", "Universidad: (Aysén) - (Magallanes)", "Área de estudio: (Salud) - (Ingeniería)", "Área de estudio: (Social) - (Ingeniería)", "Alcohol: (No) - (Sí)", "Tabaco: (No) - (Sí)", ".chain", ".iteration", ".draw")
  posterior <-as.data.table(posterior) |> 
    melt(id.vars = c(".chain", ".iteration", ".draw"))
  posterior[!grepl("Intercepto", variable)]
}) |> 
  ggplot(aes(value, variable)) +
  stat_halfeye() +
  annotate(geom = "area", 
           x = c(-.18,-.18,.18,.18), 
           y = c(0,Inf,Inf,0), alpha = .3, 
           fill = "darkred") +
  labs(y = NULL, x = "Log-odds", title = "Intensidad percibida de dolor") +
  theme_classic()

p3 <- local({
  posterior <- mc3_factores |> 
    as_draws_df(variable = "^b", regex = T)
  names(posterior) <- c("Intercepto [1]", "Intercepto [2]", "Intercepto [3]", "Intercepto [4]", "Edad (+1 SD)", "Genero: (Femenino) - (Masculino)", "Universidad: (Aysén) - (Magallanes)", "Área de estudio: (Salud) - (Ingeniería)", "Área de estudio: (Social) - (Ingeniería)", "Alcohol: (No) - (Sí)", "Tabaco: (No) - (Sí)", ".chain", ".iteration", ".draw")
  posterior <- as.data.table(posterior) |> 
    melt(id.vars = c(".chain", ".iteration", ".draw"))
  posterior[!grepl("Intercepto", variable)]
}) |> 
  ggplot(aes(value, variable)) +
  stat_halfeye() +
  annotate(geom = "area", 
           x = c(-.18,-.18,.18,.18), 
           y = c(0,Inf,Inf,0), alpha = .3, 
           fill = "darkred") +
  labs(y = NULL, x = "Log-odds", title = "Frecuencia reportada de dolor") +
  theme_classic()

p4 <- local({
  posterior <- mc4_factores |> 
    as_draws_df(variable = "^b", regex = T)
  names(posterior) <- c("Intercepto", "Edad (+1 SD)", "Genero: (Femenino) - (Masculino)", "Universidad: (Aysén) - (Magallanes)", "Área de estudio: (Salud) - (Ingeniería)", "Área de estudio: (Administrativo) - (Ingeniería)", "Área de estudio: (Social) - (Ingeniería)", "Alcohol: (No) - (Sí)", "Tabaco: (No) - (Sí)", ".chain", ".iteration", ".draw")
  posterior <- as.data.table(posterior) |> 
    melt(id.vars = c(".chain", ".iteration", ".draw"))
  posterior[!grepl("Intercepto", variable)]
}) |> 
  ggplot(aes(value, variable)) +
  stat_halfeye() +
  annotate(geom = "area", 
           x = c(-.18,-.18,.18,.18), 
           y = c(0,Inf,Inf,0), alpha = .3, 
           fill = "darkred") +
  labs(y = NULL, x = "Log-odds", title = "Probabilidad de tener dolor persistente") +
  theme_classic()

ggpubr::ggarrange(p1, p2, p3, p4, ncol = 2, nrow = 2, align = "hv")
```
**Figura 1**. Factores sociodemográficos y su efecto sobre el dolor en sus diferentes dimensiones. El área sombreada roja representa el área de equivalencia práctica (ROPE).


### Edad

```{r mod-edad}
#| eval: false
ms1_edad <- readRDS("../models/factores-y-dolor/ms1_edad.RDS")
ms2_edad <- readRDS("../models/factores-y-dolor/ms2_edad.RDS")
ms3_edad <- readRDS("../models/factores-y-dolor/ms3_edad.RDS")
ms4_edad <- readRDS("../models/factores-y-dolor/ms4_edad.RDS")
```

Al evaluar el efecto de la edad sobre los distintos dominios de dolor, observamos evidencia moderada a fuerte a favor de la hipótesis nula, lo que sugiere que la edad no tiene un efecto sobre el impacto funcional del dolor ($\beta$ = 0.05, CI 95% [-0.16, 0.24], pd = 0.67, ps = 0.08, ROPE = 0.93, BF10 = 0.037), ni sobre la intensidad reportada de dolor ($\beta$ = 0.01, CI 95% [-0.12, 0.15], pd = 0.57, ps = 0.00, ROPE = 1.00, BF10 = 0.023), ni sobre la frecuencia de dolor ($\beta$ = 0.15, CI 95% [-0.20, 0.51], pd = 0.80, ps = 0.44, ROPE = 0.56, BF10 = 0.084), así como tampoco influyó sobre la probabilidad de tener dolor persistente ($\beta$ = -0.02, CI 95% [-0.36, 0.38], pd = 0.53, ps = 0.18, ROPE = 0.70, BF10 = 0.063). 

Al controlar por la influencia de los demás factores, observamos que el efecto de la edad sobre la repercusión funcional del dolor es negativa ($\beta$ = -0.10, CI 95% [-0.37, 0.16]) con un 77% de probabilidad (pd) y una baja probabilidad de ser significativo (ps = 0.27), sin embargo, el efecto marginal de la edad sigue brindando mayor evidencia a favor de la hipótesis nula (BF10 = 0.057). En este sentido, la magnitud de evidencia observada para esta variable en modelos ajustados, no otorgó mayor evidencia a favor de la presencia de un efecto (intensidad de dolor, BF10 = 0.033; frecuencia de dolor, BF10 = 0.118; probabilidad de dolor persistente, BF10 = 0.096).

### Genero

```{r mod-genero}
#| eval: false
ms1_genero <- readRDS("../models/factores-y-dolor/ms1_genero.RDS")
ms2_genero <- readRDS("../models/factores-y-dolor/ms2_genero.RDS")
ms3_genero <- readRDS("../models/factores-y-dolor/ms3_genero.RDS")
ms4_genero <- readRDS("../models/factores-y-dolor/ms4_genero.RDS")
```

Al evaluar el efecto del género sobre los distintos dominios de dolor, observamos un 82% de probabilidad que las mujeres experimentan un mayor impacto funcional asociado al dolor ($\beta$ = 0.39, CI 95% [-0.07, 0.89], pd = 0.95, ps = 0.82, ROPE = 0.330, BF10 = 0.084), una mayor intensidad reportada de dolor ($\beta$ = 0.49, CI 95% [0.16, 0.82], pd = 0.99, ps = 0.97, ROPE = 0.009, BF10 = 4.55) y cerca de 7 veces más probabilidades de presentar dolor persistente ($\exp(\beta)$ = 6.96) que su contraparte masculina ($\beta$ = 1.94, CI 95% [1.16, 2.74], pd = 1.00, ps = 1.00, ROPE = 0.00, BF10 = 2720). Pese a lo anterior, no observamos que el efecto del género fuese significativo sobre la frecuencia del dolor ($\beta$ = -0.19, CI 95% [-1.03, 0.64], pd = 0.67, ps = 0.51, ROPE = 0.32, BF10 = 0.161).

Al controlar por la influencia de los demás factores, observamos que la magnitud de la diferencia observada entre hombres y mujeres es mayor en relación al impacto funcional del dolor ($\beta$ = 0.74, CI 95% [ 0.22, 1.28], BF10 = 4.50). Del mismo modo, valorar el efecto marginal del genero, observamos que las mujeres realmente experimentan 10 veces más probabilidades de presentar dolor persistente ($\exp(\beta)$ = 10.1, $\beta$ = 2.31, CI 95% [1.37, 3.34], pd = 1.00, ps = 1.00, ROPE = 0.00, BF10 = 9030). Por otra parte, la evidencia aportada pora los otros dominios de dolor no se vió modificado por la inclusión de las otras variables en el modelo (intensidad de dolor, BF10 = 2.04; frecuencia de dolor, BF10 = 0.204).

### Universidad de estudio

```{r mod-universidad}
#| eval: false
ms1_universidad <- readRDS("../models/factores-y-dolor/ms1_universidad.RDS")
ms2_universidad <- readRDS("../models/factores-y-dolor/ms2_universidad.RDS")
ms3_universidad <- readRDS("../models/factores-y-dolor/ms3_universidad.RDS")
ms4_universidad <- readRDS("../models/factores-y-dolor/ms4_universidad.RDS")
```

Cuando comparamos el efecto de formar parte de una casa de estudios en particular, observamos evidencia moderada que apoyaba la hipótesis nula, sugiriendo que la universidad no influye sobre el impacto funcional percibido (BF10 = 0.129), intensidad (BF10 = 0.059), ni sobre la frecuencia de dolor percibida (BF10 = 0.220). Por otro lado, hallamos evidencia anecdótica (BF10 = 0.333) que sugiere que probablemente existe un efecto significativo deesta variable (pd = 0.91, ps = 0.81), en relación que la Universidad de Aysén presenta un 77% mayores probabilidades de presentar dolor persistente que aquellos en la Universidad de Magallanes ($\exp(\beta)$ = 1.77, $\beta$ = 0.57, CI 95% [-0.28, 1.49], ROPE = 0.15). Los modelos completamente ajustados no mostraron diferencias respecto de los modelos simples.

### Área de estudio

```{r mod-area}
#| eval: false
ms1_area_estudios <- readRDS("../models/factores-y-dolor/ms1_area_estudios.RDS")
ms2_area_estudios <- readRDS("../models/factores-y-dolor/ms2_area_estudios.RDS")
ms3_area_estudios <- readRDS("../models/factores-y-dolor/ms3_area_estudios.RDS")
ms4_area_estudios <- readRDS("../models/factores-y-dolor/ms4_area_estudios.RDS")
```

Al valorar el efecto de las diferentes áreas de estudios sobre el dolor, observamos que aquellos que estudian una área relacionada con la ingeniería, esperimentan un mayor impacto en su funcionalidad debido al dolor comparado con aquellos que estudian una carrera relacionada con el área de la salud ($\exp(\beta)$ = `r round(exp(0.74), 2)`, $\beta$ = 0.74, CI 95% [0.11, 1.38], pd = 0.99, ps = 0.98, ROPE = 0.00), o de las ciencias sociales ($\exp(\beta)$ = `r round(exp(0.76), 2)`, $\beta$ = 0.76, CI 95% [-0.28, 1.77], pd = 0.93, ps = 0.90, ROPE = 0.05). En relación a la probabilidad de experimentar dolor persistente, se observó que aquellos que estudian una ingeniería presentan 7.69 veces más probabilidades que aquellos que estudian una carrera de las ciencias sociales ($\exp(\beta)$ = `r round(exp(2.04), 2)`, $\beta$ = 2.04, CI 95% [0.29, 3.92], ps = 0.99, ps = 0.99, ROPE = 0.00). Un efecto similar pudo observarse en relación a aquellos que estudian una carrera del área de la salud comparados con aquellos del área social ($\exp(\beta)$ = `r round(exp(1.34), 2)`, $\beta$ = 1.34, CI 95% [-0.14, 2.90], ps = 0.96, ps = 0.95, ROPE = 0.02).

### Consumo de alcohol

```{r mod-alcohol}
#| eval: false
ms1_consumo_alcohol <- readRDS("../models/factores-y-dolor/ms1_consumo_alcohol.RDS")
ms2_consumo_alcohol <- readRDS("../models/factores-y-dolor/ms2_consumo_alcohol.RDS")
ms3_consumo_alcohol <- readRDS("../models/factores-y-dolor/ms3_consumo_alcohol.RDS")
ms4_consumo_alcohol <- readRDS("../models/factores-y-dolor/ms4_consumo_alcohol.RDS")
```

El efecto marginal del consumo del alcohol, independiente de otros factores, se asoció únicamente a un menor impacto funcional de dolor ($\exp(\beta)$ = `r round(exp(-0.64), 2)`, $\beta$ = -0.64, CI 95% [-1.15, -0.15], ps = 0.99, ps = 0.99, ROPE = 0.00, BF10 = 2.29), sin embargo para el resto de los dominios observados, el estatus de consumo de al menos una vez por semana no se asoció a un ningún efecto sobre el dolor (intensidad del dolor, BF10 = 0.067; frecuencia del dolor, BF10 = 0.301; probabilidad de dolor persistente, BF10 = 0.218). 

### Hábito tabáquico

```{r mod-tabaco}
#| eval: false
ms1_consume_tabaco <- readRDS("../models/factores-y-dolor/ms1_consume_tabaco.RDS")
ms2_consume_tabaco <- readRDS("../models/factores-y-dolor/ms2_consume_tabaco.RDS")
ms3_consume_tabaco <- readRDS("../models/factores-y-dolor/ms3_consume_tabaco.RDS")
ms4_consume_tabaco <- readRDS("../models/factores-y-dolor/ms4_consume_tabaco.RDS")
```

A diferencia de lo observado en el caso del consumo de alcohol, el consumo de tabaco se asoció a un incremento en el impacto funcional asociado al dolor ($\exp(\beta)$ = `r round(exp(0.64), 2)`, $\beta$ = 0.64, CI 95% [0.06, 1.25], ps = 0.98, ps = 0.94, ROPE = 0.04, BF10 = 0.997) y a la frecuencia de cuadros dolorosos experimentados por los sujetos ($\exp(\beta)$ = `r round(exp(1.37), 2)`, $\beta$ = 1.37, CI 95% [0.29, 2.49], ps = 0.99, ps = 0.98, ROPE = 0.00, BF10 = 4.05). Encontramos evidencia moderada de que el consumo de tabaco no es un factor influyente en la intensidad de dolor percibido (BF10 = 0.158, 1/BF10 = 6.33) o en la probabilidad de presentar dolor persistente (BF10 = 0.209, 1/BF10 = 4.78).

## Efecto de la actividad física sobre el dolor

### Actividad física

```{r mod-af-ipaq}
mc1_score_ipaq <- readRDS("../models/af-dolor/mc1_score_ipaq.RDS")
mc2_score_ipaq <- readRDS("../models/af-dolor/mc2_score_ipaq.RDS")
mc3_score_ipaq <- readRDS("../models/af-dolor/mc3_score_ipaq.RDS")
mc4_score_ipaq <- readRDS("../models/af-dolor/mc4_score_ipaq.RDS")
```

```{r fig-ipaq}
#| fig-width: 12
#| fig-asp: .4
#| fig-column: screen-inset-left

p1 <- local({
  posterior <- mc1_score_ipaq |> 
    as_draws_df(variable = "score_ipaq", regex = T)
  names(posterior) <- c("IPAQ: (Moderado) - (Bajo)", "IPAQ: (Alto) - (Bajo)", ".chain", ".iteration", ".draw")
  posterior <-as.data.table(posterior) |> 
    melt(id.vars = c(".chain", ".iteration", ".draw"))
  posterior[!grepl("Intercepto", variable)]
}) |> 
  ggplot(aes(value, variable)) +
  stat_halfeye() +
  annotate(geom = "area", 
           x = c(-.18,-.18,.18,.18), 
           y = c(0,Inf,Inf,0), alpha = .3, 
           fill = "darkred") +
  labs(y = NULL, x = "Log-odds", title = "Impacto funcional sobre el dolor") +
  theme_classic()

p2 <- local({
  posterior <- mc2_score_ipaq |> 
    as_draws_df(variable = "score_ipaq", regex = T)
  names(posterior) <- c("IPAQ: (Moderado) - (Bajo)", "IPAQ: (Alto) - (Bajo)", ".chain", ".iteration", ".draw")
  posterior <-as.data.table(posterior) |> 
    melt(id.vars = c(".chain", ".iteration", ".draw"))
  posterior[!grepl("Intercepto", variable)]
}) |> 
  ggplot(aes(value, variable)) +
  stat_halfeye() +
  annotate(geom = "area", 
           x = c(-.18,-.18,.18,.18), 
           y = c(0,Inf,Inf,0), alpha = .3, 
           fill = "darkred") +
  labs(y = NULL, x = "Log-odds", title = "Intensidad percibida de dolor") +
  theme_classic()

p3 <- local({
  posterior <- mc3_score_ipaq |> 
    as_draws_df(variable = "score_ipaq", regex = T)
  names(posterior) <- c("IPAQ: (Moderado) - (Bajo)", "IPAQ: (Alto) - (Bajo)", ".chain", ".iteration", ".draw")
  posterior <- as.data.table(posterior) |> 
    melt(id.vars = c(".chain", ".iteration", ".draw"))
  posterior[!grepl("Intercepto", variable)]
}) |> 
  ggplot(aes(value, variable)) +
  stat_halfeye() +
  annotate(geom = "area", 
           x = c(-.18,-.18,.18,.18), 
           y = c(0,Inf,Inf,0), alpha = .3, 
           fill = "darkred") +
  labs(y = NULL, x = "Log-odds", title = "Frecuencia reportada de dolor") +
  theme_classic()

p4 <- local({
  posterior <- mc4_score_ipaq |> 
    as_draws_df(variable = "score_ipaq", regex = T)
  names(posterior) <- c("IPAQ: (Moderado) - (Bajo)", "IPAQ: (Alto) - (Bajo)", ".chain", ".iteration", ".draw")
  posterior <- as.data.table(posterior) |> 
    melt(id.vars = c(".chain", ".iteration", ".draw"))
  posterior[!grepl("Intercepto", variable)]
}) |> 
  ggplot(aes(value, variable)) +
  stat_halfeye() +
  annotate(geom = "area", 
           x = c(-.18,-.18,.18,.18), 
           y = c(0,Inf,Inf,0), alpha = .3, 
           fill = "darkred") +
  labs(y = NULL, x = "Log-odds", title = "Probabilidad de tener dolor persistente") +
  theme_classic()

ggpubr::ggarrange(p1, p2, p3, p4, ncol = 2, nrow = 2, align = "hv")
```
**Figura 2**. Niveles de actividad física y su efecto sobre el dolor en sus diferentes dimensiones. El área sombreada roja representa el área de equivalencia práctica (ROPE).

Al valorar los niveles de actividad física con el dolor, se observó que aquellos individuos con un nivel bajo de actividad física parecieran experimentar un mayor impacto funcional asociado al dolor que aquellos con un nivel moderado de actividad física ($\exp(\beta)$ = `r round(exp(0.72), 2)`, $\beta$ = 0.72, CI 95% [-0.07, 1.52], ps = 0.96, ps = 0.91, ROPE = 0.07, BF10 = 0.686), sin embargo, esta diferencia no se observó cuando se comparó con aquellos en el nivel alto de actividad física ($\exp(\beta)$ = `r round(exp(0.30), 2)`, $\beta$ = 0.30, CI 95% [-0.33, 0.92], ps = 0.84, ps = 0.65, ROPE = 0.30, BF10 = 0.170). No se observaron diferencias para los demás dominios de dolor entre niveles de actividad.

### Gasto energético

```{r mod-af-mets}
mc1_mets_total <- readRDS("../models/af-dolor/mc1_mets_total.RDS")
mc2_mets_total <- readRDS("../models/af-dolor/mc2_mets_total.RDS")
mc3_mets_total <- readRDS("../models/af-dolor/mc3_mets_total.RDS")
mc4_mets_total <- readRDS("../models/af-dolor/mc4_mets_total.RDS")
```

```{r fig-mets}
#| fig-width: 12
#| fig-asp: .3
#| fig-column: screen-inset-left
p1 <- local({
  posterior <- mc1_mets_total |> 
    as_draws_df(variable = "mets_total", regex = T)
  names(posterior) <- c("METs totales (+1 SD)", ".chain", ".iteration", ".draw")
  posterior <-as.data.table(posterior) |> 
    melt(id.vars = c(".chain", ".iteration", ".draw"))
  posterior[!grepl("Intercepto", variable)]
}) |> 
  ggplot(aes(value, variable)) +
  stat_halfeye() +
  annotate(geom = "area", 
           x = c(-.18,-.18,.18,.18), 
           y = c(0,Inf,Inf,0), alpha = .3, 
           fill = "darkred") +
  labs(y = NULL, x = "Log-odds", title = "Impacto funcional sobre el dolor") +
  theme_classic()

p2 <- local({
  posterior <- mc2_mets_total |> 
    as_draws_df(variable = "mets_total", regex = T)
  names(posterior) <- c("METs totales (+1 SD)", ".chain", ".iteration", ".draw")
  posterior <-as.data.table(posterior) |> 
    melt(id.vars = c(".chain", ".iteration", ".draw"))
  posterior[!grepl("Intercepto", variable)]
}) |> 
  ggplot(aes(value, variable)) +
  stat_halfeye() +
  annotate(geom = "area", 
           x = c(-.18,-.18,.18,.18), 
           y = c(0,Inf,Inf,0), alpha = .3, 
           fill = "darkred") +
  labs(y = NULL, x = "Log-odds", title = "Intensidad percibida de dolor") +
  theme_classic()

p3 <- local({
  posterior <- mc3_mets_total |> 
    as_draws_df(variable = "mets_total", regex = T)
  names(posterior) <- c("METs totales (+1 SD)", ".chain", ".iteration", ".draw")
  posterior <- as.data.table(posterior) |> 
    melt(id.vars = c(".chain", ".iteration", ".draw"))
  posterior[!grepl("Intercepto", variable)]
}) |> 
  ggplot(aes(value, variable)) +
  stat_halfeye() +
  annotate(geom = "area", 
           x = c(-.18,-.18,.18,.18), 
           y = c(0,Inf,Inf,0), alpha = .3, 
           fill = "darkred") +
  labs(y = NULL, x = "Log-odds", title = "Frecuencia reportada de dolor") +
  theme_classic()

p4 <- local({
  posterior <- mc4_mets_total |> 
    as_draws_df(variable = "mets_total", regex = T)
  names(posterior) <- c("METs totales (+1 SD)", ".chain", ".iteration", ".draw")
  posterior <- as.data.table(posterior) |> 
    melt(id.vars = c(".chain", ".iteration", ".draw"))
  posterior[!grepl("Intercepto", variable)]
}) |> 
  ggplot(aes(value, variable)) +
  stat_halfeye() +
  annotate(geom = "area", 
           x = c(-.18,-.18,.18,.18), 
           y = c(0,Inf,Inf,0), alpha = .3, 
           fill = "darkred") +
  labs(y = NULL, x = "Log-odds", title = "Probabilidad de tener dolor persistente") +
  theme_classic()

ggpubr::ggarrange(p1, p2, p3, p4, ncol = 2, nrow = 2, align = "hv")
```
**Figura 3**. Gasto energético asociado a la actividad física y su efecto sobre el dolor en sus diferentes dimensiones. El área sombreada roja representa el área de equivalencia práctica (ROPE).

Los equivalentes metabólicos (METs), asociados al gasto energético, se vieron asociados con una alta probabilidad posterior a una mayor intensidad de dolor a mayor gasto energético ($\exp(\beta)$ = `r round(exp(0.16), 2)`, $\beta$ = 0.16, CI 95% [-0.02, 0.36], pd = 0.95), sin embargo, la probabilidad posterior asociada a un efecto significativo es baja (ps = 0.42), con una gran proporción de la distribución posterior en la zona de equivalencia práctica (ROPE = 0.58), aportando más evidencia a la hipótesis nula después de observar los datos (BF10 = 0.120). Los datos actuales aportan mayor evidencia a favor de la hipótesis nula, sugiriendo que el gasto energético no se relaciona con el impacto funcional asociado al dolor (BF10 = 0.081), la frecuencia del dolor percibido (BF10 = 0.085) o con la probabilidad asociada a la permanencia del dolor por más de tres meses (BF10 = 0.106).

## Efecto del cronotipo y calidad de sueño sobre el dolor

### Cronotipo y dolor

```{r mod-crono-cat}
mc1_score_matutinidad <- readRDS("../models/cronotipo-dolor/mc1_score_matutinidad.RDS")
mc2_score_matutinidad <- readRDS("../models/cronotipo-dolor/mc2_score_matutinidad.RDS")
mc3_score_matutinidad <- readRDS("../models/cronotipo-dolor/mc3_score_matutinidad.RDS")
mc4_score_matutinidad <- readRDS("../models/cronotipo-dolor/mc4_score_matutinidad.RDS")
```

```{r fig-crono-cat}
#| fig-width: 12
#| fig-asp: .5
#| fig-column: screen-inset-left
p1 <- local({
  posterior <- mc1_score_matutinidad |> 
    as_draws_df(variable = "score_matutinidad", regex = T)
  names(posterior) <- c("(Vespertino moderado) - (Vespertino extremo)", "(Intermedio) - (Vespertino extremo)", "(Matutino moderado) - (Vespertino extremo)", ".chain", ".iteration", ".draw")
  posterior <-as.data.table(posterior) |> 
    melt(id.vars = c(".chain", ".iteration", ".draw"))
  posterior[!grepl("Intercepto", variable)]
}) |> 
  ggplot(aes(value, variable)) +
  stat_halfeye() +
  annotate(geom = "area", 
           x = c(-.18,-.18,.18,.18), 
           y = c(0,Inf,Inf,0), alpha = .3, 
           fill = "darkred") +
  labs(y = NULL, x = "Log-odds", title = "Impacto funcional sobre el dolor") +
  theme_classic()

p2 <- local({
  posterior <- mc2_score_matutinidad |> 
    as_draws_df(variable = "score_matutinidad", regex = T)
  names(posterior) <- c("(Vespertino moderado) - (Vespertino extremo)", "(Intermedio) - (Vespertino extremo)", "(Matutino moderado) - (Vespertino extremo)", ".chain", ".iteration", ".draw")
  posterior <-as.data.table(posterior) |> 
    melt(id.vars = c(".chain", ".iteration", ".draw"))
  posterior[!grepl("Intercepto", variable)]
}) |> 
  ggplot(aes(value, variable)) +
  stat_halfeye() +
  annotate(geom = "area", 
           x = c(-.18,-.18,.18,.18), 
           y = c(0,Inf,Inf,0), alpha = .3, 
           fill = "darkred") +
  labs(y = NULL, x = "Log-odds", title = "Intensidad percibida de dolor") +
  theme_classic()

p3 <- local({
  posterior <- mc3_score_matutinidad |> 
    as_draws_df(variable = "score_matutinidad", regex = T)
  names(posterior) <- c("(Vespertino moderado) - (Vespertino extremo)", "(Intermedio) - (Vespertino extremo)", "(Matutino moderado) - (Vespertino extremo)", ".chain", ".iteration", ".draw")
  posterior <- as.data.table(posterior) |> 
    melt(id.vars = c(".chain", ".iteration", ".draw"))
  posterior[!grepl("Intercepto", variable)]
}) |> 
  ggplot(aes(value, variable)) +
  stat_halfeye() +
  annotate(geom = "area", 
           x = c(-.18,-.18,.18,.18), 
           y = c(0,Inf,Inf,0), alpha = .3, 
           fill = "darkred") +
  labs(y = NULL, x = "Log-odds", title = "Frecuencia reportada de dolor") +
  theme_classic()

p4 <- local({
  posterior <- mc4_score_matutinidad |> 
    as_draws_df(variable = "score_matutinidad", regex = T)
  names(posterior) <- c("(Vespertino moderado) - (Vespertino extremo)", "(Intermedio) - (Vespertino extremo)", "(Matutino moderado) - (Vespertino extremo)", ".chain", ".iteration", ".draw")
  posterior <- as.data.table(posterior) |> 
    melt(id.vars = c(".chain", ".iteration", ".draw"))
  posterior[!grepl("Intercepto", variable)]
}) |> 
  ggplot(aes(value, variable)) +
  stat_halfeye() +
  annotate(geom = "area", 
           x = c(-.18,-.18,.18,.18), 
           y = c(0,Inf,Inf,0), alpha = .3, 
           fill = "darkred") +
  labs(y = NULL, x = "Log-odds", title = "Probabilidad de tener dolor persistente") +
  theme_classic()

ggpubr::ggarrange(p1, p2, p3, p4, ncol = 2, nrow = 2, align = "hv")
```
**Figura 4**. Nivel de matutinidad y su efecto sobre el dolor en sus diferentes dimensiones. El área sombreada roja representa el área de equivalencia práctica (ROPE).

Comparados con los individuos categorizados con un nivel de matutinidad equivalente a vespertinos extremos, observamos un menor impacto funcional asociado al dolor en aquellos con un nivel moderado de matutinidad ($\beta$ = -1.24, CI 95% [-2.39, -0.17], ps = 0.98, ps = 0.97, ROPE = 0.00, BF10 =  2.42), así como en aquellos considerados como matutinos moderados ($\beta$ = -1.38, CI 95% [-2.74, -0.07], ps = 0.97, ps = 0.96, ROPE = 0.01, BF10 =  2.01). Un efecto similar, pero menos marcado se observó en al comparar a los vespertinos moderados con los extremos, observando un menor impacto funcional atribuible al dolor en los primeros ($\beta$ = -1.00, CI 95% [-2.16, 0.13], ps = 0.95, ps = 0.93, ROPE = 0.05, BF10 = 0.863). No se evidenció un efecto adicional de la categoría de matutinidad sobre los otros dominios del dolor.

```{r mod-crono-score}
mc1_matutinidad_score <- readRDS("../models/cronotipo-dolor/mc1_matutinidad_score.RDS")
mc2_matutinidad_score <- readRDS("../models/cronotipo-dolor/mc2_matutinidad_score.RDS")
mc3_matutinidad_score <- readRDS("../models/cronotipo-dolor/mc3_matutinidad_score.RDS")
mc4_matutinidad_score <- readRDS("../models/cronotipo-dolor/mc4_matutinidad_score.RDS")
```

```{r fig-crono-score}
#| fig-width: 12
#| fig-asp: .4
#| fig-column: screen-inset-left
p1 <- local({
  posterior <- mc1_matutinidad_score |> 
    as_draws_df(variable = "matutinidad_score", regex = T)
  names(posterior) <- c("Matutinidad score (+1 SD)", ".chain", ".iteration", ".draw")
  posterior <-as.data.table(posterior) |> 
    melt(id.vars = c(".chain", ".iteration", ".draw"))
  posterior[!grepl("Intercepto", variable)]
}) |> 
  ggplot(aes(value, variable)) +
  stat_halfeye() +
  annotate(geom = "area", 
           x = c(-.18,-.18,.18,.18), 
           y = c(0,Inf,Inf,0), alpha = .3, 
           fill = "darkred") +
  labs(y = NULL, x = "Log-odds", title = "Impacto funcional sobre el dolor") +
  theme_classic()

p2 <- local({
  posterior <- mc2_matutinidad_score |> 
    as_draws_df(variable = "matutinidad_score", regex = T)
  names(posterior) <- c("Matutinidad score (+1 SD)", ".chain", ".iteration", ".draw")
  posterior <-as.data.table(posterior) |> 
    melt(id.vars = c(".chain", ".iteration", ".draw"))
  posterior[!grepl("Intercepto", variable)]
}) |> 
  ggplot(aes(value, variable)) +
  stat_halfeye() +
  annotate(geom = "area", 
           x = c(-.18,-.18,.18,.18), 
           y = c(0,Inf,Inf,0), alpha = .3, 
           fill = "darkred") +
  labs(y = NULL, x = "Log-odds", title = "Intensidad percibida de dolor") +
  theme_classic()

p3 <- local({
  posterior <- mc3_matutinidad_score |> 
    as_draws_df(variable = "matutinidad_score", regex = T)
  names(posterior) <- c("Matutinidad score (+1 SD)", ".chain", ".iteration", ".draw")
  posterior <- as.data.table(posterior) |> 
    melt(id.vars = c(".chain", ".iteration", ".draw"))
  posterior[!grepl("Intercepto", variable)]
}) |> 
  ggplot(aes(value, variable)) +
  stat_halfeye() +
  annotate(geom = "area", 
           x = c(-.18,-.18,.18,.18), 
           y = c(0,Inf,Inf,0), alpha = .3, 
           fill = "darkred") +
  labs(y = NULL, x = "Log-odds", title = "Frecuencia reportada de dolor") +
  theme_classic()

p4 <- local({
  posterior <- mc4_matutinidad_score |> 
    as_draws_df(variable = "matutinidad_score", regex = T)
  names(posterior) <- c("Matutinidad score (+1 SD)", ".chain", ".iteration", ".draw")
  posterior <- as.data.table(posterior) |> 
    melt(id.vars = c(".chain", ".iteration", ".draw"))
  posterior[!grepl("Intercepto", variable)]
}) |> 
  ggplot(aes(value, variable)) +
  stat_halfeye() +
  annotate(geom = "area", 
           x = c(-.18,-.18,.18,.18), 
           y = c(0,Inf,Inf,0), alpha = .3, 
           fill = "darkred") +
  labs(y = NULL, x = "Log-odds", title = "Probabilidad de tener dolor persistente") +
  theme_classic()

ggpubr::ggarrange(p1, p2, p3, p4, ncol = 2, nrow = 2, align = "hv")
```
**Figura 5**. Puntaje de matutinidad y su efecto sobre el dolor en sus diferentes dimensiones. El área sombreada roja representa el área de equivalencia práctica (ROPE).

Cuando usamos el puntaje de matutinidad para valorar el efecto de la matutinidad sobre el dolor, observamos que el tener un mayor puntaje, lo que se asocia a ser una persona más matutina, se asoció con un impacto funcional asociado al dolor más bajo ($\beta$ = -0.03, CI 95% [-0.06, 0.00], ps = 0.98), sin embargo, la magnitud del efecto observado puede considerarse insignificante desde un sentido práctico (ps = 0.00, ROPE = 1.00), aportando evidencia fuerte a favor de la hipótesis nula (BF10 = 0.069, 1/BF10 = 14.49). El puntaje de matutinidad no se asoció a otros dominios de dolor después de ajustar por variables sociodemográficas.

### Calidad de sueño y dolor

```{r mod-psqi-score}
mc1_clasificacion_global <- readRDS("../models/psqi-dolor/mc1_clasificacion_global.RDS")
mc2_clasificacion_global <- readRDS("../models/psqi-dolor/mc2_clasificacion_global.RDS")
mc3_clasificacion_global <- readRDS("../models/psqi-dolor/mc3_clasificacion_global.RDS")
mc4_clasificacion_global <- readRDS("../models/psqi-dolor/mc4_clasificacion_global.RDS")
```

```{r fig-psqi-score}
#| fig-width: 12
#| fig-asp: .4
#| fig-column: screen-inset-left

p1 <- local({
  posterior <- mc1_clasificacion_global |> 
    as_draws_df(variable = "clasificacion_global", regex = T)
  names(posterior) <- c("PSQI score (+1 SD)", ".chain", ".iteration", ".draw")
  posterior <-as.data.table(posterior) |> 
    melt(id.vars = c(".chain", ".iteration", ".draw"))
  posterior[!grepl("Intercepto", variable)]
}) |> 
  ggplot(aes(value, variable)) +
  stat_halfeye() +
  annotate(geom = "area", 
           x = c(-.18,-.18,.18,.18), 
           y = c(0,Inf,Inf,0), alpha = .3, 
           fill = "darkred") +
  labs(y = NULL, x = "Log-odds", title = "Impacto funcional sobre el dolor") +
  theme_classic()

p2 <- local({
  posterior <- mc2_clasificacion_global |> 
    as_draws_df(variable = "clasificacion_global", regex = T)
  names(posterior) <- c("PSQI score (+1 SD)", ".chain", ".iteration", ".draw")
  posterior <-as.data.table(posterior) |> 
    melt(id.vars = c(".chain", ".iteration", ".draw"))
  posterior[!grepl("Intercepto", variable)]
}) |> 
  ggplot(aes(value, variable)) +
  stat_halfeye() +
  annotate(geom = "area", 
           x = c(-.18,-.18,.18,.18), 
           y = c(0,Inf,Inf,0), alpha = .3, 
           fill = "darkred") +
  labs(y = NULL, x = "Log-odds", title = "Intensidad percibida de dolor") +
  theme_classic()

p3 <- local({
  posterior <- mc3_clasificacion_global |> 
    as_draws_df(variable = "clasificacion_global", regex = T)
  names(posterior) <- c("PSQI score (+1 SD)", ".chain", ".iteration", ".draw")
  posterior <- as.data.table(posterior) |> 
    melt(id.vars = c(".chain", ".iteration", ".draw"))
  posterior[!grepl("Intercepto", variable)]
}) |> 
  ggplot(aes(value, variable)) +
  stat_halfeye() +
  annotate(geom = "area", 
           x = c(-.18,-.18,.18,.18), 
           y = c(0,Inf,Inf,0), alpha = .3, 
           fill = "darkred") +
  labs(y = NULL, x = "Log-odds", title = "Frecuencia reportada de dolor") +
  theme_classic()

p4 <- local({
  posterior <- mc4_clasificacion_global |> 
    as_draws_df(variable = "clasificacion_global", regex = T)
  names(posterior) <- c("PSQI score (+1 SD)", ".chain", ".iteration", ".draw")
  posterior <- as.data.table(posterior) |> 
    melt(id.vars = c(".chain", ".iteration", ".draw"))
  posterior[!grepl("Intercepto", variable)]
}) |> 
  ggplot(aes(value, variable)) +
  stat_halfeye() +
  annotate(geom = "area", 
           x = c(-.18,-.18,.18,.18), 
           y = c(0,Inf,Inf,0), alpha = .3, 
           fill = "darkred") +
  labs(y = NULL, x = "Log-odds", title = "Probabilidad de tener dolor persistente") +
  theme_classic()

ggpubr::ggarrange(p1, p2, p3, p4, ncol = 2, nrow = 2, align = "hv")
```
**Figura 6**. Puntaje del PSQI y su efecto sobre el dolor en sus diferentes dimensiones. El área sombreada roja representa el área de equivalencia práctica (ROPE).

En relación al puntaje total del PSQI, que un mayor puntaje se traduce en peor calidad de sueño, observamos que a mayor puntaje existe un mayor impacto funcional asociado al dolor ($\beta$ = 0.06, CI 95% [0.00, 0.12], pd = 0.97), sin embargo y debido a la magnitud del efecto observado, este no puede considerarse significativo en un sentido practico (ps = 0.00, ROPE = 1.00), aportando evidencia fuerte a favor de la hipótesis nula (BF10 = 0.058, 1/BF10 = 17.24). En relación a la frecuencia reportada de dolor percibido, observamos que por cada incremento en 1 desviación estándar en el puntaje del PSQI, existe un 26% mayores probabilidades de observar una mayor frecuencia de dolor ($\exp(\beta)$ = `r round(exp(0.23),2)`, $\beta$ = 0.23, CI 95% [0.11, 0.37], pd = 1.00, ps = 0.78, ROPE = 0.21, BF10 = 10.34). Por otro lado, la evidencia obtenida después de observar los datos, provee evidencia muy fuerte a favor de la ausencia de un efecto entre el puntaje del PSQI y la intensidad percibida del dolor (BF10 = 0.017, 1/BF10 = 58.82), así como evidencia fuerte respecto a la hipótesis nula en la probabilidad de presentar dolor persistente (BF10 = 0.054, 1/BF10 =  18.52).

```{r mod-psqi-horas}
mc1_pittsburg_horasdormidas <- readRDS("../models/psqi-dolor/mc1_pittsburg_horasdormidas.RDS")
mc2_pittsburg_horasdormidas <- readRDS("../models/psqi-dolor/mc2_pittsburg_horasdormidas.RDS")
mc3_pittsburg_horasdormidas <- readRDS("../models/psqi-dolor/mc3_pittsburg_horasdormidas.RDS")
mc4_pittsburg_horasdormidas <- readRDS("../models/psqi-dolor/mc4_pittsburg_horasdormidas.RDS")
```

```{r fig-psqi-horas}
#| fig-width: 12
#| fig-asp: .4
#| fig-column: screen-inset-left

p1 <- local({
  posterior <- mc1_pittsburg_horasdormidas |> 
    as_draws_df(variable = "pittsburg_horasdormidas", regex = T)
  names(posterior) <- c("Horas dormidas (+1 SD)", ".chain", ".iteration", ".draw")
  posterior <-as.data.table(posterior) |> 
    melt(id.vars = c(".chain", ".iteration", ".draw"))
  posterior[!grepl("Intercepto", variable)]
}) |> 
  ggplot(aes(value, variable)) +
  stat_halfeye() +
  annotate(geom = "area", 
           x = c(-.18,-.18,.18,.18), 
           y = c(0,Inf,Inf,0), alpha = .3, 
           fill = "darkred") +
  labs(y = NULL, x = "Log-odds", title = "Impacto funcional sobre el dolor") +
  theme_classic()

p2 <- local({
  posterior <- mc2_pittsburg_horasdormidas |> 
    as_draws_df(variable = "pittsburg_horasdormidas", regex = T)
  names(posterior) <- c("Horas dormidas (+1 SD)", ".chain", ".iteration", ".draw")
  posterior <-as.data.table(posterior) |> 
    melt(id.vars = c(".chain", ".iteration", ".draw"))
  posterior[!grepl("Intercepto", variable)]
}) |> 
  ggplot(aes(value, variable)) +
  stat_halfeye() +
  annotate(geom = "area", 
           x = c(-.18,-.18,.18,.18), 
           y = c(0,Inf,Inf,0), alpha = .3, 
           fill = "darkred") +
  labs(y = NULL, x = "Log-odds", title = "Intensidad percibida de dolor") +
  theme_classic()

p3 <- local({
  posterior <- mc3_pittsburg_horasdormidas |> 
    as_draws_df(variable = "pittsburg_horasdormidas", regex = T)
  names(posterior) <- c("Horas dormidas (+1 SD)", ".chain", ".iteration", ".draw")
  posterior <- as.data.table(posterior) |> 
    melt(id.vars = c(".chain", ".iteration", ".draw"))
  posterior[!grepl("Intercepto", variable)]
}) |> 
  ggplot(aes(value, variable)) +
  stat_halfeye() +
  annotate(geom = "area", 
           x = c(-.18,-.18,.18,.18), 
           y = c(0,Inf,Inf,0), alpha = .3, 
           fill = "darkred") +
  labs(y = NULL, x = "Log-odds", title = "Frecuencia reportada de dolor") +
  theme_classic()

p4 <- local({
  posterior <- mc4_pittsburg_horasdormidas |> 
    as_draws_df(variable = "pittsburg_horasdormidas", regex = T)
  names(posterior) <- c("Horas dormidas (+1 SD)", ".chain", ".iteration", ".draw")
  posterior <- as.data.table(posterior) |> 
    melt(id.vars = c(".chain", ".iteration", ".draw"))
  posterior[!grepl("Intercepto", variable)]
}) |> 
  ggplot(aes(value, variable)) +
  stat_halfeye() +
  annotate(geom = "area", 
           x = c(-.18,-.18,.18,.18), 
           y = c(0,Inf,Inf,0), alpha = .3, 
           fill = "darkred") +
  labs(y = NULL, x = "Log-odds", title = "Probabilidad de tener dolor persistente") +
  theme_classic()

ggpubr::ggarrange(p1, p2, p3, p4, ncol = 2, nrow = 2, align = "hv")
```
**Figura 7**. Horas de sueño por noche y su efecto sobre el dolor en sus diferentes dimensiones. El área sombreada roja representa el área de equivalencia práctica (ROPE).

En el caso de las horas de sueño, evidencia fuerte a muy fuerte a favor de la hipotesis nula se obtuvo después de observar los datos, indicando que las horas de sueño no ejercen ninguna influencia significativa sobre el impacto funcional asociado al dolor (ROPE = 1.00, BF10 = 0.027), intensidad percibida del dolor (ROPE = 1.00, BF10 = 0.019), frecuencia reportada del dolor percibido (ROPE = 0.85, BF10 = 0.046) y de la probabilidad asociada a la presencia de dolor persistente (ROPE = 0.79, BF10 = 0.052). 
